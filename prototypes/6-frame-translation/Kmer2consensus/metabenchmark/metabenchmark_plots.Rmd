---
title: "Metabenchmark seed extend analyse"
author: "Aranka Steyaert"
date: "5/20/2017"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(car) 
```

```{r read data, include=FALSE}
mat <- read.csv("Metabench_analyse.LCA.csv")
mat.mrl <- read.csv("Metabench_analyse.MRL.csv")
mat.hyb <- read.csv("Metabench_analyse.Hybrid06.csv")
mat.hyb2 <- read.csv("Metabench_analyse.Hybrid04.csv")
data_frame <- as.data.frame(mat)
data_frame.mrl <- as.data.frame(mat.mrl)
data_frame.hyb <- as.data.frame(mat.hyb)
data_frame.hyb2 <- as.data.frame(mat.hyb2)
data_frame$length_type <- paste(data_frame$seed_length,data_frame$score, sep=";")
data_frame.mrl$length_type <- paste(data_frame.mrl$seed_length,data_frame.mrl$score, sep=";")
data_frame.hyb$length_type <- paste(data_frame.hyb$seed_length,data_frame.hyb$score, sep=";")
data_frame.hyb2$length_type <- paste(data_frame.hyb2$seed_length,data_frame.hyb2$score, sep=";")

```
## Enkele Plots met gemiddelde van precisie en sensitiviteit

gap-penalty lijkt niet veel invloed te hebben in aanwezigheid van de andere parameters:


```{r summary}
summary(data_frame)
summary(data_frame.mrl)
summary(data_frame.hyb)
summary(data_frame.hyb2)
```

### Enkel gap penalty = 0.5

```{r gereduceerd , echo=FALSE,results='hide',message=FALSE}
scatterplot(mean_prec ~ mean_sens | seed_length,data=data_frame,smoother=FALSE,
            reg.line=FALSE,labels = data_frame[,"score"],
            id.n = nrow(data_frame),id.cex = 0.7, main="LCA*")
scatterplot(mean_prec ~ mean_sens | seed_length,data=data_frame.mrl,smoother=FALSE,
            reg.line=FALSE,labels = data_frame.mrl[,"score"],
            id.n = nrow(data_frame.mrl),id.cex = 0.7,main="MRL")
scatterplot(mean_prec ~ mean_sens | seed_length,data=data_frame.hyb,smoother=FALSE,
            reg.line=FALSE,labels = data_frame.hyb[,"score"],
            id.n = nrow(data_frame.hyb),id.cex = 0.7,main="Hybride 0.6")
scatterplot(mean_prec ~ mean_sens | seed_length,data=data_frame.hyb2,smoother=FALSE,
            reg.line=FALSE,labels = data_frame.hyb2[,"score"],
            id.n = nrow(data_frame.hyb2),id.cex = 0.7,main="Hybride 0.4")

scatterplot(genus_prec ~ genus_sens | seed_length,data=data_frame, smoother=FALSE,
            reg.line=FALSE,labels = rownames(mat),id.n = nrow(data_frame),id.cex = 0.7, main="LCA*,genus")
scatterplot(species_prec ~ species_sens | seed_length,data=data_frame, smoother=FALSE,
            reg.line=FALSE,labels = rownames(mat),id.n = nrow(data_frame),id.cex = 0.7, main="LCA*,species")

scatterplot(genus_prec ~ genus_sens | seed_length,data=data_frame.mrl, smoother=FALSE,
            reg.line=FALSE,labels = rownames(mat.mrl),id.n = nrow(data_frame.mrl),id.cex = 0.7,main="MRL,genus")
scatterplot(species_prec ~ species_sens | seed_length,data=data_frame.mrl, smoother=FALSE,
            reg.line=FALSE,labels = rownames(mat.mrl),id.n = nrow(data_frame.mrl),id.cex = 0.7,main="MRL,species")

scatterplot(genus_prec ~ genus_sens | seed_length,data=data_frame.hyb, smoother=FALSE,
            reg.line=FALSE,labels = rownames(mat.hyb),id.n = nrow(data_frame.hyb),id.cex = 0.7,main="Hybride 0.6, genus")
scatterplot(species_prec ~ species_sens | seed_length,data=data_frame.hyb, smoother=FALSE,
            reg.line=FALSE,labels = rownames(mat.hyb),id.n = nrow(data_frame.hyb),id.cex = 0.7,main="Hybride 0.6, species")

scatterplot(genus_prec ~ genus_sens | seed_length,data=data_frame.hyb2, smoother=FALSE,
            reg.line=FALSE,labels = rownames(mat.hyb2),id.n = nrow(data_frame.hyb2),id.cex = 0.7,main="Hybride 0.4, genus")
scatterplot(species_prec ~ species_sens | seed_length,data=data_frame.hyb2, smoother=FALSE,
            reg.line=FALSE,labels = rownames(mat.hyb2),id.n = nrow(data_frame.hyb2),id.cex = 0.7,main="Hybride 0.4, species")
```

labels = type model:
1: kiest beste seed en houdt rekening met lengte van die seed in de score
2: geeft alle extended seeds terug
3: kiest beste seed, maar middelt score uit over de lengte


\newpage

## Een aantal conlusies

* totaal aantal identificaties afhankelijk van de lengte van de seeds

  ```{r IDs en seed_length, echo = FALSE, fig.height = 3.5, fig.width=3.5}
  scatterplot(IDs~seed_length, data = data_frame, smoother=FALSE,main="LCA*")
  scatterplot(IDs~seed_length, data = data_frame.mrl, smoother=FALSE,main="MRL")
  scatterplot(IDs~seed_length, data = data_frame.hyb, smoother=FALSE,main="Hybride 0.6")
  scatterplot(IDs~seed_length, data = data_frame.hyb2, smoother=FALSE,main="Hybride 0.4")
  ```

* precisie stijgt met de seed lengte vooral voor algoritme type 3 is het belangrijk om een grotere seed lengte te hebben

  ```{r precisie en seed lengte, echo = FALSE, fig.height = 4, fig.width=4}
  scatterplot(seed_length~mean_prec | score, data=data_frame, smoother=FALSE,main="LCA*")
  scatterplot(seed_length~mean_prec | score, data=data_frame.mrl, smoother=FALSE,main="MRL")
  scatterplot(seed_length~mean_prec | score, data=data_frame.hyb, smoother=FALSE,main="Hybride 0.6")
  scatterplot(seed_length~mean_prec | score, data=data_frame.hyb2, smoother=FALSE,main="Hybride 0.4")
  ```
  
* zodra de seedlengte en type model vastliggen zorgt de grootte van gaps voor een daling in sensitiviteit en een stijging in precisie

* wanneer lengte van de seeds = 2 werkt enkel model type 1, type 2 geeft slechte sensitiviteit, type 3 geeft slechte precisie
    + reden? 
    + door geen rekening te houden met lengte van de extended seed selecteert 3 waarschijnlijk de kleine foute seeds (2x zelfde species niveau, maar fout zal hogere uitgemiddelde score hebben dan een lange met een aantal juiste op species, maar ook wat gaps en wat hoger gelegen identificaties)
    + door alle extended seeds terug te geven blijven er met seed lengte = 2 nog een aantal fouten over die het consensustaxon op root of bacteria e.d. zetten --> in totaal minder diepe identificaties trekt sensitiviteit naar omlaag, maar van alle identificaties die op een diep niveau geraken zijn er wel redelijk veel juist dus toch hoge precisie
    + Met model type 1 is de sensitiviteit het hoogst (ook in vgl met andere seed lengtes), maar om zo veel te detecteren boet je wel wat in aan precisie om dat je ondanks deze redelijk goede filter methode toch iets meer foute identificaties door het net laat glippen ook.
  ```{r overzicht, echo = FALSE, fig.height = 4, fig.width=6}
  scatterplot(mean_prec ~ mean_sens | length_type,data=data_frame, smoother=FALSE,reg.line=FALSE, cex.axis=0.7,cex = 0.7, legend.coords="bottomleft",legend.columns=3,main="LCA*")
  scatterplot(mean_prec ~ mean_sens | length_type,data=data_frame.mrl, smoother=FALSE,reg.line=FALSE, cex.axis=0.7,cex = 0.7, legend.coords="bottomright",legend.columns=3,main="MRL")
  scatterplot(mean_prec ~ mean_sens | length_type,data=data_frame.hyb, smoother=FALSE,reg.line=FALSE, cex.axis=0.7,cex = 0.7, legend.coords="bottomright",legend.columns=3,main="Hybride 0.6")
  scatterplot(mean_prec ~ mean_sens | length_type,data=data_frame.hyb2, smoother=FALSE,reg.line=FALSE, cex.axis=0.7,cex = 0.7, legend.coords="bottomright",legend.columns=3,main="Hybride 0.4")
  
  ```
  
\newpage

## Plots voor Species en Genus niveau


```{r species genus, echo=FALSE,results='hide',message=FALSE}
scatterplot(genus_prec ~ genus_sens | length_type,data=data_frame, smoother=FALSE,reg.line=FALSE,labels = mat[,"gap_size"],id.n = nrow(data_frame),id.cex = 0.4,main="LCA",legend.coords="bottomleft",legend.columns=3, cex.axis=0.7,cex = 0.7,cex.lab=0.7)

scatterplot(genus_prec ~ genus_sens | length_type,data=data_frame.mrl, smoother=FALSE,reg.line=FALSE, cex.axis=0.7,cex = 0.7, legend.coords="bottomleft",legend.columns=3,main="MRL",cex.lab=0.7)

scatterplot(genus_prec ~ genus_sens | length_type,data=data_frame.hyb, smoother=FALSE,reg.line=FALSE,labels = mat[,"gap_size"],id.n = nrow(data_frame.hyb),id.cex = 0.4, cex.axis=0.7,cex = 0.7, legend.coords="bottomleft",legend.columns=3,main="hyb06",cex.lab=0.7)

scatterplot(genus_prec ~ genus_sens | length_type,data=data_frame.hyb2, smoother=FALSE,reg.line=FALSE,labels = mat[,"gap_size"],id.n = nrow(data_frame.hyb2),id.cex = 0.4, cex.axis=0.7,cex = 0.7, legend.coords="bottomleft",legend.columns=3,main="hyb04",cex.lab=0.7)
```


```{r fn genus, echo=FALSE,results='hide',message=FALSE}
scatterplot(genus_spec ~ genus_npv | length_type,data=data_frame, smoother=FALSE,reg.line=FALSE,labels = mat[,"gap_size"],id.n = nrow(data_frame),id.cex = 0.4,main="HiSeq",legend.coords="bottomleft",legend.columns=3, cex.axis=0.7,cex = 0.7,cex.lab=0.7)

scatterplot(genus_spec ~ genus_npv | length_type,data=data_frame.mrl, smoother=FALSE,reg.line=FALSE, cex.axis=0.7,cex = 0.7, legend.coords="bottomleft",legend.columns=3,main="HiSeq,MRL",cex.lab=0.7)

scatterplot(genus_spec ~ genus_npv | length_type,data=data_frame.hyb, smoother=FALSE,reg.line=FALSE,labels = mat[,"gap_size"],id.n = nrow(data_frame),id.cex = 0.4, cex.axis=0.7,cex = 0.7, legend.coords="bottomleft",legend.columns=3,main="HiSeq,hyb06",cex.lab=0.7)

scatterplot(genus_spec ~ genus_npv | length_type,data=data_frame.hyb2, smoother=FALSE,reg.line=FALSE,labels = mat[,"gap_size"],id.n = nrow(data_frame),id.cex = 0.4, cex.axis=0.7,cex = 0.7, legend.coords="bottomleft",legend.columns=3,main="HiSeq,hyb04",cex.lab=0.7)
```

```{r scatter matrix LCA, echo=FALSE}
scatterplotMatrix(~genus_prec+genus_sens+genus_spec+genus_npv|length_type,data=data_frame, smoother=FALSE, reg.line=FALSE, diagonal="none",
   main="Metabenchmark, LCA*")
```


```{r scatter MRL}
scatterplotMatrix(~genus_prec+genus_sens+genus_spec+genus_npv|length_type,data=data_frame.mrl, smoother=FALSE, reg.line=FALSE, diagonal="none",
   main="Metabenchmark, MRL")
```

```{r scatter hybride06}
scatterplotMatrix(~genus_prec+genus_sens+genus_spec+genus_npv|length_type,data=data_frame.hyb, smoother=FALSE, reg.line=FALSE, diagonal="none",
   main="Metabenchmark, Hybride")
```

```{r scatter hybride04}
scatterplotMatrix(~genus_prec+genus_sens+genus_spec+genus_npv|length_type,data=data_frame.hyb2, smoother=FALSE, reg.line=FALSE, diagonal="none",
   main="Metabenchmark, Hybride 0.4")
```

```{r species, echo=FALSE,results='hide',message=FALSE}

scatterplot(species_prec ~ species_sens | length_type,data=data_frame, smoother=FALSE,
            reg.line=FALSE,labels =mat.mrl[,"gap_size"],id.n = nrow(data_frame),id.cex = 0.7,main="LCA*")
scatterplot(species_prec ~ species_sens | length_type,data=data_frame.mrl, smoother=FALSE,
            reg.line=FALSE,labels =mat[,"gap_size"],id.n = nrow(data_frame.mrl),id.cex = 0.7,main="MRL")

scatterplot(species_prec ~ species_sens | length_type,data=data_frame.hyb, smoother=FALSE,
            reg.line=FALSE,labels =mat[,"gap_size"],id.n = nrow(data_frame.hyb),id.cex = 0.7,main="Hyb 06")

scatterplot(species_prec ~ species_sens | length_type,data=data_frame.hyb2, smoother=FALSE,
            reg.line=FALSE,labels =mat[,"gap_size"],id.n = nrow(data_frame.hyb2),id.cex = 0.7,main="Hyb 04")
```

